---
title: "Séquence 1 : Statistiques Descriptives & R"
#| label: fig-salaires
#| fig-cap: "Dispersion des salaires"
#| echo: true
#| code-fold: true
#| output-location: default
#| code-summary: "Voir le code R"
#| fig-height: 5
#| fig-width: 9
#| lightbox: true
library(ggplot2)
install.packages(c("tidyverse", "ggplot2", "quarto", "rmarkdown"))
install.packages(c("tidyverse", "ggplot2", "quarto", "rmarkdown"))
#| label: setup
#| echo: true
#| message: false
#| warning: false
library(ggplot2)
library(dplyr)
library(readxl)
# --- ÉTAPE 1 : DÉFINIR LE FICHIER ---
# Remplacez ce chemin par le vôtre !
mon_fichier <- "C:/Users/oflah/Downloads/DonneesTD1.xlsx"
# --- ÉTAPE 2 : IMPORTER ---
df <- read_excel(mon_fichier)
# Aperçu
head(df, 3)
#| label: q9-multi
#| echo: true
# Modèle : Espérance de vie s'explique par (~) PIB + Education
modele <- lm(`Esp Vie Naiss 2017` ~ `PIB/tête (2017)` + `Années éducation (2017)`, data = df)
# Résultats sommaires
summary(modele)$coefficients
#| label: setup
#| echo: true
#| message: false
#| warning: false
library(ggplot2)
library(dplyr)
library(readxl)
# --- ÉTAPE 1 : DÉFINIR LE FICHIER ---
# Remplacez ce chemin par le vôtre !
mon_fichier <- "C:/Users/oflah/Downloads/DonneesTD1.xlsx"
# --- ÉTAPE 2 : IMPORTER ---
df <- read_excel(mon_fichier)
# Aperçu
head(df, 3)
#| label: q10-final
#| echo: true
# 1. Moyenne des pays (Moyenne simple)
moy_pays <- mean(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# 2. Moyenne mondiale (Moyenne pondérée par la population)
# Elle représente l'espérance de vie d'un "humain moyen" de notre échantillon
moy_monde <- weighted.mean(df$`Esp Vie Naiss 2017`,
w = df$`Population totale (2017)`,
na.rm = TRUE)
# 3. Variance inter-pays
# C'est la variabilité entre les moyennes des pays
var_inter <- var(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# Affichage
data.frame(
Indicateur = c("Moyenne (Pays)", "Moyenne (Monde)", "Variance Inter-Pays"),
Valeur = c(moy_pays, moy_monde, var_inter)
) %>% knitr::kable(digits = 2)
#| label: q10-monde-pondere
#| echo: true
# 1. Moyenne Mondiale (Pondérée)
# C'est l'espérance de vie moyenne d'un être humain sur Terre (dans notre échantillon)
moy_monde <- weighted.mean(df$`Esp Vie Naiss 2017`,
w = df$`Population totale (2017)`,
na.rm = TRUE)
# 2. Variance Inter-Pays (Pondérée)
# Formule : Somme(Pop * (Esp - Moy)^2) / Somme(Pop)
var_inter <- sum(df$`Population totale (2017)` * (df$`Esp Vie Naiss 2017` - moy_monde)^2, na.rm = TRUE) /
sum(df$`Population totale (2017)`, na.rm = TRUE)
# Affichage des résultats
data.frame(
Indicateur = c("Espérance de vie (Monde)", "Variance Inter-Pays (Pondérée)", "Ecart-type Inter-Pays"),
Valeur = c(moy_monde, var_inter, sqrt(var_inter))
) %>% knitr::kable(digits = 2)
#| label: setup
#| echo: true
#| message: false
#| warning: false
library(ggplot2)
library(dplyr)
library(readxl)
# --- ÉTAPE 1 : DÉFINIR LE FICHIER ---
# Remplacez ce chemin par le vôtre !
mon_fichier <- "C:/Users/oflah/Downloads/DonneesTD1.xlsx"
# --- ÉTAPE 2 : IMPORTER ---
df <- read_excel(mon_fichier)
# Aperçu
head(df, 3)
#| label: q2-stats
#| echo: true
# Calcul des indicateurs pour l'Espérance de vie
df %>% summarise(
Moyenne = mean(`Esp Vie Naiss 2017`, na.rm = TRUE),
Variance = var(`Esp Vie Naiss 2017`, na.rm = TRUE),
Ecart_Type = sd(`Esp Vie Naiss 2017`, na.rm = TRUE)
) %>% knitr::kable(digits = 2)
#| label: q3-quantiles
#| echo: true
# La fonction quantile fait tout d'un coup
quantile(df$`Esp Vie Naiss 2017`,
probs = c(0.1, 0.25, 0.5, 0.75, 0.9),
na.rm = TRUE)
#| label: q4-boxplot
#| fig-height: 5
ggplot(df, aes(y = `Esp Vie Naiss 2017`)) +
geom_boxplot(fill = "#404080", color = "black", alpha = 0.6) +
labs(title = "Q4 - Espérance de vie : Boite à moustaches", y = "Années") +
theme_minimal() +
theme(axis.text.x = element_blank())
#| label: q5-sorted-bars
#| fig-height: 5
# 1. On trie les données (comme sur Excel)
df_trie <- df %>%
filter(!is.na(`Esp Vie Naiss 2017`)) %>%
arrange(`Esp Vie Naiss 2017`) %>%
mutate(Rang = row_number()) # On crée un numéro d'ordre (1, 2, 3...)
# 2. On trace des BÂTONS (geom_col)
ggplot(df_trie, aes(x = Rang, y = `Esp Vie Naiss 2017`)) +
geom_col(fill = "#404080", width = 0.8) +
# On ajoute la ligne de la Médiane (Horizontalement)
geom_hline(yintercept = median(df_trie$`Esp Vie Naiss 2017`),
color = "#b89e14", size = 1.5) +
annotate("text", x = 5, y = 78, label = "Médiane", color = "#b89e14", fontface = "bold") +
labs(title = "Q5 : Distribution de l'Espérance de vie (Triée)",
y = "Espérance de vie (en années)",
x = "Pays") +
theme_minimal()
#| label: q6-histo-clean
#| fig-height: 5
ggplot(df, aes(x = `Esp Vie Naiss 2017`)) +
geom_histogram(
binwidth = 5,       # Largeur de 5 ans
boundary = 50,      # On force le démarrage sur un chiffre rond (50)
closed = "left",    # L'intervalle est [50, 55[ (50 inclus, 55 exclu)
fill = "#1591EA",
color = "white"
) +
# C'est ici qu'on force l'affichage des bornes sur l'axe X
scale_x_continuous(breaks = seq(50, 90, 5)) +
labs(
title = "Q6 : Histogramme (Classes de 5 ans)",
subtitle = "Chaque barre représente une tranche stricte (ex: [75 à 80[ ans)",
y = "Nombre de pays",
x = "Espérance de vie"
) +
theme_minimal()
#| label: q7-cov-cor
#| echo: true
# 1. Sélection des variables
vars <- df %>%
select(`IDH 2017`, `PIB/tête (2017)`, `Esp Vie Naiss 2017`, `Années éducation (2017)`)
# 2. Matrice de COVARIANCE (Brute)
# Difficile à interpréter car les unités sont mélangées ($ * Années)
print("--- Matrice de COVARIANCE ---")
cov(vars, use = "complete.obs") %>% round(1)
# 3. Matrice de CORRÉLATION (Standardisée)
# Idéale pour voir les liens avec l'IDH (Max = 1)
print("--- Matrice de CORRÉLATION ---")
cor(vars, use = "complete.obs") %>% round(2)
#| label: q8-reg
#| fig-height: 5
ggplot(df, aes(x = `PIB/tête (2017)`, y = `Esp Vie Naiss 2017`)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", color = "#C04657", se = FALSE) + # Droite de régression
labs(title = "Q8 : Régression linéaire", x = "PIB ($)", y = "Espérance de vie") +
theme_minimal()
#| label: q9-multi-final
#| echo: true
# Modèle sans le Palma (données manquantes) et sans l'IDH (tautologie)
modele_safe <- lm(`Esp Vie Naiss 2017` ~ `PIB/tête (2017)` +
`Années éducation (2017)` +
`Population totale (2017)`,
data = df)
# Affichage des coefficients arrondis
summary(modele_safe)$coefficients %>% round(5)
#| label: q10-monde-pondere
#| echo: true
# 1. Moyenne Mondiale (Pondérée)
# C'est l'espérance de vie moyenne d'un être humain sur Terre (dans notre échantillon)
# Moyenne non pondérée
moy_Q2 <- mean(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# Moyenne pondérée
moy_monde <- weighted.mean(df$`Esp Vie Naiss 2017`,
w = df$`Population totale (2017)`,
na.rm = TRUE)
# 2. Variance Inter-Pays (Pondérée)
# Formule : Somme(Pop * (Esp - Moy)^2) / Somme(Pop)
# Variance non pondérée
var_Q2 <- var(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# Écart type non pondérée
sd_Q2 <- sd(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# Moyenne pondérée
var_inter <- sum(df$`Population totale (2017)` * (df$`Esp Vie Naiss 2017` - moy_monde)^2, na.rm = TRUE) /
sum(df$`Population totale (2017)`, na.rm = TRUE)
# Affichage des résultats
data.frame(
Indicateur = c("Espérance de vie (Q2 - non pondérée)", "Espérance de vie (Monde - pondérée)", "Variance non pondérée", "Variance Inter-Pays (Pondérée)", "Ecart-type non pondéré", "Ecart-type Inter-Pays"),
Valeur = c(moy_Q2, moy_monde, var_Q2, var_inter, sd_Q2, sqrt(var_inter)) # sqrt -> racine carré de la variance
) %>% knitr::kable(digits = 2)
#| label: setup
#| echo: true
#| message: false
#| warning: false
library(ggplot2)
library(dplyr)
library(readxl)
# --- ÉTAPE 1 : DÉFINIR LE FICHIER ---
# Remplacez ce chemin par le vôtre !
mon_fichier <- "C:/Users/oflah/Downloads/DonneesTD1.xlsx"
# --- ÉTAPE 2 : IMPORTER ---
df <- read_excel(mon_fichier)
# Aperçu
head(df, 3)
#| label: q2-stats
#| echo: true
# Calcul des indicateurs pour l'Espérance de vie
df %>% summarise(
Moyenne = mean(`Esp Vie Naiss 2017`, na.rm = TRUE),
Variance = var(`Esp Vie Naiss 2017`, na.rm = TRUE),
Ecart_Type = sd(`Esp Vie Naiss 2017`, na.rm = TRUE)
) %>% knitr::kable(digits = 2)
#| label: q3-quantiles
#| echo: true
# La fonction quantile fait tout d'un coup
quantile(df$`Esp Vie Naiss 2017`,
probs = c(0.1, 0.25, 0.5, 0.75, 0.9),
na.rm = TRUE)
#| label: q4-boxplot
#| fig-height: 5
ggplot(df, aes(y = `Esp Vie Naiss 2017`)) +
geom_boxplot(fill = "#404080", color = "black", alpha = 0.6) +
labs(title = "Q4 - Espérance de vie : Boite à moustaches", y = "Années") +
theme_minimal() +
theme(axis.text.x = element_blank())
#| label: q5-sorted-bars
#| fig-height: 5
# 1. On trie les données (comme sur Excel)
df_trie <- df %>%
filter(!is.na(`Esp Vie Naiss 2017`)) %>%
arrange(`Esp Vie Naiss 2017`) %>%
mutate(Rang = row_number()) # On crée un numéro d'ordre (1, 2, 3...)
# 2. On trace des BÂTONS (geom_col)
ggplot(df_trie, aes(x = Rang, y = `Esp Vie Naiss 2017`)) +
geom_col(fill = "#404080", width = 0.8) +
# On ajoute la ligne de la Médiane (Horizontalement)
geom_hline(yintercept = median(df_trie$`Esp Vie Naiss 2017`),
color = "#b89e14", size = 1.5) +
annotate("text", x = 5, y = 78, label = "Médiane", color = "#b89e14", fontface = "bold") +
labs(title = "Q5 : Distribution de l'Espérance de vie (Triée)",
y = "Espérance de vie (en années)",
x = "Pays") +
theme_minimal()
#| label: q6-histo-clean
#| fig-height: 5
ggplot(df, aes(x = `Esp Vie Naiss 2017`)) +
geom_histogram(
binwidth = 5,       # Largeur de 5 ans
boundary = 50,      # On force le démarrage sur un chiffre rond (50)
closed = "left",    # L'intervalle est [50, 55[ (50 inclus, 55 exclu)
fill = "#1591EA",
color = "white"
) +
# C'est ici qu'on force l'affichage des bornes sur l'axe X
scale_x_continuous(breaks = seq(50, 90, 5)) +
labs(
title = "Q6 : Histogramme (Classes de 5 ans)",
subtitle = "Chaque barre représente une tranche stricte (ex: [75 à 80[ ans)",
y = "Nombre de pays",
x = "Espérance de vie"
) +
theme_minimal()
#| label: q7-cov-cor
#| echo: true
# 1. Sélection des variables
vars <- df %>%
select(`IDH 2017`, `PIB/tête (2017)`, `Esp Vie Naiss 2017`, `Années éducation (2017)`)
# 2. Matrice de COVARIANCE (Brute)
# Difficile à interpréter car les unités sont mélangées ($ * Années)
print("--- Matrice de COVARIANCE ---")
cov(vars, use = "complete.obs") %>% round(1)
# 3. Matrice de CORRÉLATION (Standardisée)
# Idéale pour voir les liens avec l'IDH (Max = 1)
print("--- Matrice de CORRÉLATION ---")
cor(vars, use = "complete.obs") %>% round(2)
#| label: q8-reg
#| fig-height: 5
ggplot(df, aes(x = `PIB/tête (2017)`, y = `Esp Vie Naiss 2017`)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", color = "#C04657", se = FALSE) + # Droite de régression
labs(title = "Q8 : Régression linéaire", x = "PIB ($)", y = "Espérance de vie") +
theme_minimal()
#| label: q9-multi-final
#| echo: true
# Modèle sans le Palma (données manquantes) et sans l'IDH (tautologie)
modele_safe <- lm(`Esp Vie Naiss 2017` ~ `PIB/tête (2017)` +
`Années éducation (2017)` +
`Population totale (2017)`,
data = df)
# Affichage des coefficients arrondis
summary(modele_safe)$coefficients %>% round(5)
#| label: q10-monde-pondere
#| echo: true
# 1. Moyenne Mondiale (Pondérée)
# C'est l'espérance de vie moyenne d'un être humain sur Terre (dans notre échantillon)
# Moyenne non pondérée
moy_Q2 <- mean(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# Moyenne pondérée
moy_monde <- weighted.mean(df$`Esp Vie Naiss 2017`,
w = df$`Population totale (2017)`,
na.rm = TRUE)
# 2. Variance Inter-Pays (Pondérée)
# Formule : Somme(Pop * (Esp - Moy)^2) / Somme(Pop)
# Variance non pondérée
var_Q2 <- var(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# Écart type non pondérée
sd_Q2 <- sd(df$`Esp Vie Naiss 2017`, na.rm = TRUE)
# Moyenne pondérée
var_inter <- sum(df$`Population totale (2017)` * (df$`Esp Vie Naiss 2017` - moy_monde)^2, na.rm = TRUE) /
sum(df$`Population totale (2017)`, na.rm = TRUE)
# Affichage des résultats
data.frame(
Indicateur = c("Espérance de vie (Q2 - non pondérée)", "Espérance de vie (Monde - pondérée)", "Variance non pondérée", "Variance Inter-Pays (Pondérée)", "Ecart-type non pondéré", "Ecart-type Inter-Pays"),
Valeur = c(moy_Q2, moy_monde, var_Q2, var_inter, sd_Q2, sqrt(var_inter)) # sqrt -> racine carré de la variance
) %>% knitr::kable(digits = 2)
---
title: "Séquence 1 : Prise en main & statistiques descriptives"
### A. Une distribution mondiale étonnamment stable (Q2 vs Q10)
Contrairement à l'intuition, la prise en compte de la taille de la populaiton démographie ne change presque rien aux résultats globaux sur cet échantillon :
