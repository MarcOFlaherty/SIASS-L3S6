---
title: "S√©quence 2 : Sociologie √©lectorale & In√©galit√©s"
subtitle: "Analyse du vote parisien (Pr√©sidentielle 2022)"
author: "Marc O'Flaherty"
format: 
  revealjs:
    theme: simple
    slide-number: c/t
    lightbox: true
    chalkboard: true
    footer: "S√©quence 2 - L3 Sciences Sociales"
    echo: true
---

# Introduction & Donn√©es
*Le vote est-il une question de revenus ?*

## Le jeu de donn√©es {.scrollable}

Nous analysons les r√©sultats du 1er tour 2022 dans les **20 arrondissements de Paris**.

* **Source :** Julia Cag√© & Thomas Piketty (*Une histoire du conflit politique*) + INSEE.
* **Variables :**
    * `M√©diane du revenu` : Niveau de richesse de l'arrondissement.
    * `Votes (%)` : M√©lenchon (JLM), Zemmour (EZ), Le Pen (MLP), Macron (EM).

::: {.callout-note}
### Hypoth√®se de travail
Existe-t-il une corr√©lation lin√©aire entre la richesse d'un arrondissement et son orientation politique ?
:::

## Pr√©paration des donn√©es

::: {.panel-tabset}

### üü¢ Excel
1. Ouvrez votre fichier Excel.


### üîµ R (Importation)
::: {style="max-height: 400px; overflow-y: auto;"}
```{r}
#| label: setup-data
#| echo: true
#| message: false

library(tidyverse)
library(ggplot2)
library(readxl) # N√©cessaire pour lire le Excel

# --- √âTAPE 1 : D√âFINIR LE CHEMIN ---
mon_fichier <- "data/DonneesTD2.xlsx"

# --- √âTAPE 2 : IMPORTER ET RENOMMER ---
df <- read_excel(mon_fichier) %>%
  rename( # Fonction pour renommer mes variables
    # Nouveau_Nom = Ancien_Nom_Excel
    Arrondissement = IDCOM,
    JLM = pvoixMELENCHON,
    EZ = pvoixZEMMOUR,
    MLP = pvoixMLEPEN,
    EM = pvoixMACRON,
    Revenu = `M√©diane du revenu disponible par unit√© de consommation en 2019, en euros`
  )

# Aper√ßu pour v√©rifier que tout va bien
head(df, 3)
```
:::
:::

# 1. Statistiques Univari√©es
*Min, Max, Dispersion*

## Indicateurs de position et dispersion {.scrollable}

Calculez les indicateurs suivants pour toutes les variables (Revenus et Candidats).

::: {.panel-tabset}
### üü¢ Formules Excel
| Indicateur | Formule Excel |
| :--- | :--- |
| **Min** | `=MIN(Plage)`|  
| **Quartile 1 (Q1)** | `=QUARTILE.EXC(Plage; 1)` |
| **M√©diane (Q2)** | `=MEDIANE(Plage)` |
| **Quartile 3 (Q3)** | `=QUARTILE.EXC(Plage; 3)` |
| **Max** |`=MAX(Plage)` |  
| **√âtendue** | `= MAX(Plage) - MIN(Plage)` |
| **√âcart Inter-Q (EIQ)** | `= Q3 - Q1` (Calcul manuel) |
| **EIQ Relatif** | `= EIQ / M√©diane` (Calcul manuel) |
| **Rapport Inter-Q** | `= Q3 / Q1` (Calcul manuel) |
| **Variance** | `=VAR.S(Plage)` |
| **√âcart-Type** | `=ECARTYPE.STANDARD(Plage)` |
| **Coeff. Variation** | `= Ecart-Type / Moyenne` |

### üîµ Code R
```{r}
#| label: univar
#| echo: true
#| message: false

library(dplyr)
library(tidyr)

# Calcul group√© pour TOUTES les variables (Logique SQL : GROUP BY)
tableau_stats <- df %>%
  select(Revenu, JLM, EZ, MLP, EM) %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valeur") %>%
  group_by(Variable) %>%
  summarise(
    Min = min(Valeur),
    Q1 = quantile(Valeur, 0.25),
    Mediane = median(Valeur),
    Q3 = quantile(Valeur, 0.75),
    Max = max(Valeur),
    Etendue = max(Valeur) - min(Valeur),
    EIQ = quantile(Valeur, 0.75) - quantile(Valeur, 0.25),
    EIQ_Rel = (quantile(Valeur, 0.75) - quantile(Valeur, 0.25)) / median(Valeur),
    Rap_IQ = quantile(Valeur, 0.75) / quantile(Valeur, 0.25),
    Var = var(Valeur),
    Ecart_Type = sd(Valeur),
    CV = sd(Valeur) / mean(Valeur)
  ) %>%
  mutate(across(where(is.numeric), ~round(., 3)))

print(tableau_stats)
```
:::

## Interpr√©tation des r√©sultats {.scrollable}

::: {.callout-note icon=false}
### üí° Lecture 1 : Les extr√™mes et la dispersion absolue (EIQ et √âtendue)
L'observation des indicateurs bruts nous montre la r√©alit√© g√©ographique des votes sur le territoire parisien :

* **Le grand √©cart (M√©lenchon) :** C'est le vote le plus polaris√© en valeur absolue. Son score varie de **9%** √† **47%** (une √âtendue massive de 38 points). La moiti√© centrale de ses √©lecteurs est dispers√©e sur une large plage de 16 points (son EIQ).
* **L'homog√©n√©it√© (Macron) :** Bien qu'il ait une √©tendue de 25 points, sa m√©diane est tr√®s haute (41%). Son EIQ de 12 points montre une base √©lectorale large et pr√©sente dans quasiment tous les arrondissements.
* **Le plafond de verre (Le Pen) :** Avec un minimum √† 4% et un maximum √† 7%, l'√©tendue est de seulement 3 points. Le vote est uniform√©ment faible et ne varie quasiment pas (EIQ de 1 point).
:::

::: {.callout-tip icon=false}
### üéØ Lecture 2 : La dispersion relative (L'intensit√© de la s√©gr√©gation)

C'est ici que le **Coefficient de Variation (CV)** et l'**EIQ Relatif** r√©v√®lent la vraie sociologie des votes. En divisant la dispersion par le score moyen/m√©dian, on neutralise la taille du candidat :

* **Le miroir Zemmour / M√©lenchon :** Zemmour a un tout petit EIQ brut (4 points) contre 16 pour M√©lenchon. Pourtant, leurs indicateurs relatifs sont quasi identiques : **CV √† 42%** et **EIQ Relatif autour de 60%**. Cela prouve sociologiquement que ces deux votes fonctionnent exactement de la m√™me mani√®re : ce sont des votes de "niche" extr√™mement concentr√©s dans certains arrondissements sp√©cifiques. Passer d'un quartier √† un autre fait doubler ou diviser par deux leur score (Rapport Inter-Q > 170%).
* **L'alignement Macron / Revenus :** Le vote Macron affiche un CV de **20%** et un EIQ relatif de **29%**, ce qui est remarquablement proche de la dispersion des revenus parisiens (CV **20%**, EIQ Relatif **24%**). Cela illustre une s√©gr√©gation mod√©r√©e et spatialement tr√®s √©tal√©e.
:::


# 2. Analyse Bivari√©e
*Lien Revenu / Vote*

## Corr√©lation et R√©gression ($r$ et $R^2$) {.scrollable}

On cherche √† analyser la relation entre le vote de chaque candidat ($Y$) et le revenu m√©dian ($X$).

::: {.panel-tabset}
### üü¢ Formules Excel
Pour un candidat donn√© (ex: colonne EM) en fonction du Revenu :

| Indicateur | Formule Excel |
| :--- | :--- |
| **Covariance** | `=COVARIANCE.PEARSON(Col_Vote; Col_Revenu)` |
| **Corr√©lation ($r$)** | `=COEFFICIENT.CORRELATION(Col_Vote; Col_Revenu)` |
| **R¬≤ (D√©termination)** | `=COEFFICIENT.DETERMINATION(Col_Vote; Col_Revenu)` |

*Note : Le R¬≤ peut aussi s'obtenir simplement en mettant le $r$ au carr√© (`= Cellule_r ^ 2`).*

### üîµ Code R
```{r}
#| label: bivar-revenu
#| echo: true
#| message: false

library(dplyr)
library(tidyr)

# Calcul des indicateurs bivari√©s pour chaque candidat par rapport au Revenu
tableau_bivarie <- df %>%
  # 1. On garde le Revenu (notre X) et on rassemble les candidats (nos Y)
  select(Revenu, JLM, EZ, MLP, EM) %>%
  pivot_longer(cols = -Revenu, names_to = "Candidat", values_to = "Score_Vote") %>%
  # 2. On groupe par candidat (√©quivalent d'un GROUP BY)
  group_by(Candidat) %>%
  # 3. On calcule les trois indicateurs demand√©s
  summarise(
    Covariance = cov(Score_Vote, Revenu),
    r = cor(Score_Vote, Revenu),
    R2 = cor(Score_Vote, Revenu)^2
  ) %>%
  # 4. On arrondit pour la lisibilit√©
  mutate(across(where(is.numeric), ~round(., 3)))

print(tableau_bivarie)
```

:::

## Interpr√©tation des r√©sultats {.scrollable}

::: {.callout-note icon=false}
### üí° Interpr√©tation des r√©sultats
* **La Covariance :** Elle indique le sens de la relation (positive ou n√©gative), mais sa valeur brute est difficile √† interpr√©ter car elle d√©pend des unit√©s (ici, on multiplie des % par des euros).
* **Le coefficient de corr√©lation ($r$) :** Il standardise la relation entre -1 et 1.
    * EM et EZ ($r > 0$) : Corr√©lation **positive** (plus le revenu monte, plus le vote monte).
    * JLM ($r < 0$) : Corr√©lation **n√©gative** (plus le revenu monte, plus le vote baisse).
* **Le $R^2$ (Pouvoir explicatif) :** C'est le pourcentage de la variance du vote qui est "expliqu√©" par le revenu. Par exemple, si le $R^2$ de Macron est de $0.85$, cela signifie que **85% des √©carts de vote pour Macron d'un arrondissement √† l'autre s'expliquent uniquement par la diff√©rence de revenu**.
:::


# 3. Visualisation
*Nuage de points*

## Graphique comparatif {.scrollable}

Repr√©sentez les votes EZ, EM et JLM en fonction du revenu sur un m√™me graphique.

::: {.panel-tabset}
### üü¢ Excel
1. S√©lectionnez la colonne `Revenu` (X) et les colonnes `JLM`, `EZ`, `EM` (Y).
2. Insertion > Nuage de points.
3. Le revenu doit √™tre en axe horizontal (Abscisses).

### üîµ R (ggplot)
```{r}
#| label: plot-votes
#| echo: true
#| fig-height: 4

ggplot(df, aes(x = Revenu)) +
  geom_point(aes(y = EM, color = "Macron"), size=3) +
  geom_smooth(aes(y = EM, color = "Macron"), method="lm", se=FALSE) +
  
  geom_point(aes(y = JLM, color = "M√©lenchon"), size=3) +
  geom_smooth(aes(y = JLM, color = "M√©lenchon"), method="lm", se=FALSE) +
  
  geom_point(aes(y = EZ, color = "Zemmour"), size=3) +
  geom_smooth(aes(y = EZ, color = "Zemmour"), method="lm", se=FALSE) +
  
  # Axe X : Espace pour les milliers
  scale_x_continuous(labels = scales::label_number(big.mark = " ")) +
  
  # Axe Y : Conversion automatique 0.3 -> 30%
  # accuracy = 1 permet d'arrondir √† l'entier (30% et pas 30.0%)
  scale_y_continuous(labels = scales::label_percent(accuracy = 1)) +
  # ----------------------
  
  labs(title = "Vote selon le revenu √† Paris", y = "% de voix", x = "Revenu M√©dian (‚Ç¨)") +
  theme_minimal()
```
:::

# 4. Cartographie (Khartis)
*Spatialisation du vote*

## Consignes Khartis {.scrollable}

R√©alisez 4 cartes distinctes (JLM, EZ, EM, Revenu) pour comparer les g√©ographies.

1.  **Import :** Copiez les colonnes `IDCOM` (Arrondissement), `Votes` et `Revenu` dans Khartis.
2.  **Fond de carte :** Arrondissements de Paris (code postal ou INSEE).
3.  **Visualisation :**
    * Variable de Ratio (%) $\rightarrow$ **Couleurs Ordonn√©es** (Choropl√®the).
    * Discr√©tisation : Essayez *Jenks* ou *Quantiles* pour bien voir les contrastes.
4.  **Export :** T√©l√©chargez les 4 images pour les mettre c√¥te √† c√¥te dans votre rapport.

::: {.callout-tip}
### Ce qu'il faut regarder
Observez l'opposition **Est / Ouest** parisienne. Le vote M√©lenchon se superpose-t-il aux zones √† bas revenus ? Le vote Zemmour suit-il la m√™me g√©ographie que le vote Macron ?
:::

# 5. Analyse Sociologique
*Synth√®se des r√©sultats et infographies*

## Interpr√©tation des r√©sultats (Donn√©es + Images) {.scrollable}

En vous appuyant sur vos calculs et les graphiques fournis :

### 1. La polarisation √©conomique (Vos calculs)
* **Macron / Zemmour :** Forte corr√©lation positive avec le revenu. Ce sont des votes de classes ais√©es (Ouest Parisien).
* **M√©lenchon :** Forte corr√©lation n√©gative. Vote des quartiers populaires (Nord-Est).
* **Le Pen :** Faiblement repr√©sent√©e √† Paris, corr√©lation moins nette (vote plus p√©ri-urbain/rural que parisien intra-muros).

### 2. Les dynamiques historiques (Infographies)
* **Le basculement ouvrier :** Historiquement √† gauche (Mitterrand 81), le vote ouvrier s'est effondr√© vers l'abstention et l'extr√™me droite.
* **Le vote "Cadre" :** C≈ìur de l'√©lectorat Macron (et Zemmour √† Paris), alors qu'il se partageait davantage auparavant.
* **L'abstention :** Tr√®s marqu√©e chez les ouvriers/employ√©s, faible chez les cadres. Cela renforce le poids politique des classes ais√©es.

::: {.callout-important}
### Conclusion
√Ä Paris, le revenu est un **pr√©dicteur presque parfait** du vote ($R^2 > 0.9$ pour EM et JLM). La fracture g√©ographique Est/Ouest recoupe parfaitement la fracture sociale.
:::

::: {.callout-note appearance="minimal"}
### üîó Acc√©der au corrig√©
[Cliquez ici pour acc√©der au Excel corrig√©](https://y.yarn.co/6e13b700-cce4-47e6-a5db-5999fd581141_text.gif)
:::