---
title: "S√©quence 2 : Sociologie √©lectorale & In√©galit√©s"
subtitle: "Analyse du vote parisien (Pr√©sidentielle 2022)"
author: "Marc O'Flaherty"
format: 
  revealjs:
    theme: simple
    slide-number: c/t
    lightbox: true
    chalkboard: true
    footer: "S√©quence 2 - L3 Sciences Sociales"
    echo: true
---

# Introduction & Donn√©es
*Le vote est-il une question de revenus ?*

## Le jeu de donn√©es {.scrollable}

Nous analysons les r√©sultats du 1er tour 2022 dans les **20 arrondissements de Paris**.

* **Source :** Julia Cag√© & Thomas Piketty (*Une histoire du conflit politique*) + INSEE.
* **Variables :**
    * `M√©diane du revenu` : Niveau de richesse de l'arrondissement.
    * `Votes (%)` : M√©lenchon (JLM), Zemmour (EZ), Le Pen (MLP), Macron (EM).

::: {.callout-note}
### Hypoth√®se de travail
Existe-t-il une corr√©lation lin√©aire entre la richesse d'un arrondissement et son orientation politique ?
:::

## Pr√©paration des donn√©es

::: {.panel-tabset}

### üü¢ Excel
1. Ouvrez votre fichier Excel.


### üîµ R (Importation)
::: {style="max-height: 400px; overflow-y: auto;"}
```{r}
#| label: setup-data
#| echo: true
#| message: false

library(tidyverse)
library(ggplot2)
library(readxl) # N√©cessaire pour lire le Excel

# --- √âTAPE 1 : D√âFINIR LE CHEMIN ---
mon_fichier <- "data/DonneesTD2.xlsx"

# --- √âTAPE 2 : IMPORTER ET RENOMMER ---
df <- read_excel(mon_fichier) %>%
  rename( # Fonction pour renommer mes variables
    # Nouveau_Nom = Ancien_Nom_Excel
    Arrondissement = IDCOM,
    JLM = pvoixMELENCHON,
    EZ = pvoixZEMMOUR,
    MLP = pvoixMLEPEN,
    EM = pvoixMACRON,
    Revenu = `M√©diane du revenu disponible par unit√© de consommation en 2019, en euros`
  )

# Aper√ßu pour v√©rifier que tout va bien
head(df, 3)
```
:::
:::

# 1. Statistiques Univari√©es
*Min, Max, Dispersion*

## Indicateurs de position et dispersion {.scrollable}

Calculez les indicateurs suivants pour toutes les variables (Revenus et Candidats).

::: {.panel-tabset}
### üü¢ Formules Excel
| Indicateur | Formule Excel (Fr) |
| :--- | :--- |
| **Min** | `=MIN(Plage)`|  
| **Max** |`=MAX(Plage)` |  
| **Moyenne** | `=MOYENNE(Plage)` |
| **M√©diane** | `=MEDIANE(Plage)` |
| **Quartile 1** | `=QUARTILE.EXC(Plage; 1)` |
| **Quartile 3** | `=QUARTILE.EXC(Plage; 3)` |
| **√âcart Inter-Q** | `= Q3 - Q1` (Calcul manuel) |
| **Variance** | `=VAR.S(Plage)` |
| **√âcart-Type** | `=ECARTYPE.STANDARD(Plage)` |
| **Coeff. Variation** | `= EcartType / Moyenne` |

### üîµ Code R
```{r}
#| label: univar
#| echo: true

# R√©sum√© rapide avec summary()
summary(df$Revenu)

# Exemple calcul manuel Coefficient de variation pour Macron
cv_macron <- sd(df$EM) / mean(df$EM)
print(paste("CV Macron :", round(cv_macron, 3)))
```
Le coefficient de variation du vote Macron est de 0,204 (ou 20,4 %). Cela indique une **dispersion mod√©r√©e** des r√©sultats autour de la moyenne.  
Si le CV √©tait de 0,05 (5 %) : Le vote serait **identique** partout  
Si le CV √©tait de 0,85 (80 %) : Il y aurait une **√©norme disparit√©** entre les diff√©rents arrondissement  

:::

# 2. Analyse Bivari√©e
*Lien Revenu / Vote*

## Corr√©lation et R√©gression ($r$ et $R^2$) {.scrollable}

On cherche √† expliquer le vote ($Y$) par le revenu ($X$).

::: {.panel-tabset}
### üü¢ Excel
1.  **Corr√©lation ($r$) :** `=COEFFICIENT.CORRELATION(Col_Revenu; Col_Vote)`
    * *Rappel :* Proche de 1 ou -1 = Lien fort.
2.  **R√©gression Lin√©aire :** * Donn√©es > Utilitaire d'analyse > R√©gression.
    * **Y :** Colonne Vote (ex: % Macron).
    * **X :** Colonne Revenu.

### üîµ R (Matrice)
```{r}
#| label: correlation
#| echo: true

# On s√©lectionne uniquement les colonnes num√©riques pour la corr√©lation
matrice_cor <- df %>% 
  select(Revenu, JLM, EZ, MLP, EM)

cor(matrice_cor, use = "complete.obs") %>% round(2)
```
*Lecture R :*   
‚Ä¢ EM vs Revenu = **Positif fort** (Les riches votent Macron).  
‚Ä¢ JLM vs Revenu = **N√©gatif fort** (Les moins riches votent M√©lenchon).
‚Ä¢ Dans les quartiers o√π Macron fait un bon score, on observe que Zemmour fait aussi un score √©lev√©.
:::

# 3. Visualisation
*Nuage de points*

## Graphique comparatif {.scrollable}

Repr√©sentez les votes EZ, EM et JLM en fonction du revenu sur un m√™me graphique.

::: {.panel-tabset}
### üü¢ Excel
1. S√©lectionnez la colonne `Revenu` (X) et les colonnes `JLM`, `EZ`, `EM` (Y).
2. Insertion > Nuage de points.
3. Le revenu doit √™tre en axe horizontal (Abscisses).

### üîµ R (ggplot)
```{r}
#| label: plot-votes
#| echo: true
#| fig-height: 4

ggplot(df, aes(x = Revenu)) +
  geom_point(aes(y = EM, color = "Macron"), size=3) +
  geom_smooth(aes(y = EM, color = "Macron"), method="lm", se=FALSE) +
  
  geom_point(aes(y = JLM, color = "M√©lenchon"), size=3) +
  geom_smooth(aes(y = JLM, color = "M√©lenchon"), method="lm", se=FALSE) +
  
  geom_point(aes(y = EZ, color = "Zemmour"), size=3) +
  geom_smooth(aes(y = EZ, color = "Zemmour"), method="lm", se=FALSE) +
  
  # Axe X : Espace pour les milliers
  scale_x_continuous(labels = scales::label_number(big.mark = " ")) +
  
  # Axe Y : Conversion automatique 0.3 -> 30%
  # accuracy = 1 permet d'arrondir √† l'entier (30% et pas 30.0%)
  scale_y_continuous(labels = scales::label_percent(accuracy = 1)) +
  # ----------------------
  
  labs(title = "Vote selon le revenu √† Paris", y = "% de voix", x = "Revenu M√©dian (‚Ç¨)") +
  theme_minimal()
```
:::

# 4. Cartographie (Khartis)
*Spatialisation du vote*

## Consignes Khartis {.scrollable}

R√©alisez 4 cartes distinctes (JLM, EZ, EM, Revenu) pour comparer les g√©ographies.

1.  **Import :** Copiez les colonnes `IDCOM` (Arrondissement), `Votes` et `Revenu` dans Khartis.
2.  **Fond de carte :** Arrondissements de Paris (code postal ou INSEE).
3.  **Visualisation :**
    * Variable de Ratio (%) $\rightarrow$ **Couleurs Ordonn√©es** (Choropl√®the).
    * Discr√©tisation : Essayez *Jenks* ou *Quantiles* pour bien voir les contrastes.
4.  **Export :** T√©l√©chargez les 4 images pour les mettre c√¥te √† c√¥te dans votre rapport.

::: {.callout-tip}
### Ce qu'il faut regarder
Observez l'opposition **Est / Ouest** parisienne. Le vote M√©lenchon se superpose-t-il aux zones √† bas revenus ? Le vote Zemmour suit-il la m√™me g√©ographie que le vote Macron ?
:::

# 5. Analyse Sociologique
*Synth√®se des r√©sultats et infographies*

## Interpr√©tation des r√©sultats (Donn√©es + Images) {.scrollable}

En vous appuyant sur vos calculs et les graphiques fournis :

### 1. La polarisation √©conomique (Vos calculs)
* **Macron / Zemmour :** Forte corr√©lation positive avec le revenu. Ce sont des votes de classes ais√©es (Ouest Parisien).
* **M√©lenchon :** Forte corr√©lation n√©gative. Vote des quartiers populaires (Nord-Est).
* **Le Pen :** Faiblement repr√©sent√©e √† Paris, corr√©lation moins nette (vote plus p√©ri-urbain/rural que parisien intra-muros).

### 2. Les dynamiques historiques (Infographies)
* **Le basculement ouvrier :** Historiquement √† gauche (Mitterrand 81), le vote ouvrier s'est effondr√© vers l'abstention et l'extr√™me droite.
* **Le vote "Cadre" :** C≈ìur de l'√©lectorat Macron (et Zemmour √† Paris), alors qu'il se partageait davantage auparavant.
* **L'abstention :** Tr√®s marqu√©e chez les ouvriers/employ√©s, faible chez les cadres. Cela renforce le poids politique des classes ais√©es.

::: {.callout-important}
### Conclusion
√Ä Paris, le revenu est un **pr√©dicteur presque parfait** du vote ($R^2 > 0.9$ pour EM et JLM). La fracture g√©ographique Est/Ouest recoupe parfaitement la fracture sociale.
:::

::: {.callout-note appearance="minimal"}
### üîó Acc√©der au corrig√©
[Cliquez ici pour acc√©der au Excel corrig√©](https://y.yarn.co/6e13b700-cce4-47e6-a5db-5999fd581141_text.gif)
:::